export function parseMcpError(body: unknown): { code: number; message: string } {
  const top = asRecord(body);
  const error = asRecord(top.error);
  const code = error.code;
  const message = error.message;

  if (typeof code !== 'number') {
    throw new Error('Expected MCP error code');
  }
  if (typeof message !== 'string') {
    throw new Error('Expected MCP error message');
  }

  return { code, message };
}
