ON CONFLICT(name) Bug - Intentionally Preserved
================================================

In src/secrets/repo.ts setSecret(), the raw SQL uses:

  ON CONFLICT(name) DO UPDATE SET value=excluded.value, updated_at=excluded.updated_at

This means: when a secret with the same NAME exists (regardless of scope),
the existing record is updated in-place â€” the scope of the original record is preserved,
and the new scope parameter is IGNORED on conflict.

This is a bug from the original service.ts:604-606 that is intentionally preserved
per user instruction: "no schema changes" and "preserve the ON CONFLICT(name) quirk".

The correct behavior would be ON CONFLICT(name, scope) to allow per-scope secrets,
but that would require a schema change (removing the PRIMARY KEY on name alone).

Evidence: src/secrets/repo.ts line 66-68
  sql.unsafe(
    `INSERT INTO secrets (name, value, scope, created_at, updated_at) VALUES (?, ?, ?, ?, ?)
    ON CONFLICT(name) DO UPDATE SET value=excluded.value, updated_at=excluded.updated_at`,
    [name, value, scope, now, now]
  )
