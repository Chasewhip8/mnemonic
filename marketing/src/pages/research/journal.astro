---
import ResearchLayout from '../../layouts/ResearchLayout.astro';
import DoItWithDeja from '../../components/DoItWithDeja.astro';
import { getConceptBySlug } from '../../data/research';
const concept = getConceptBySlug('journal')!;
---

<ResearchLayout concept={concept}>
  <!-- Demo -->
  <div slot="demo">
    <div class="journal-demo bg-void-deep border border-brass/15 rounded-sm overflow-hidden">
      <!-- Header -->
      <div class="flex flex-wrap items-center justify-between gap-2 px-5 py-3 border-b border-brass/10 bg-steel/50">
        <div class="font-mono text-[10px] font-bold tracking-widest uppercase text-brass/60">Activity Timeline</div>
        <div class="font-mono text-[10px] text-chrome-dark/30">Feb 14 -- Feb 18, 2025</div>
      </div>

      <!-- Timeline -->
      <div class="relative px-5 py-6 max-h-[440px] overflow-y-auto journal-scroll" id="journal-timeline">
        <!-- Animated pulse line -->
        <div class="absolute left-[29px] top-0 bottom-0 w-px bg-brass/10">
          <div class="journal-pulse-line"></div>
        </div>

        <!-- Day: Tuesday Feb 18 -->
        <div class="journal-day mb-8" data-day="0">
          <div class="flex items-center gap-3 mb-4 relative">
            <div class="w-[10px] h-[10px] rounded-full bg-void-deep border-2 border-brass/40 z-10 relative left-[-1px]"></div>
            <span class="font-serif text-[14px] font-semibold text-chrome/90">Tuesday, Feb 18</span>
            <span class="font-mono text-[10px] text-chrome-dark/30 ml-auto">3 learnings, 1 recall</span>
          </div>

          <div class="ml-7 space-y-2">
            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">14:32</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Discovered that production builds require <code class="text-[11px] bg-brass/10 text-brass/80 px-1 rounded">--no-cache</code> to avoid stale layers</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.95</span></div>
                    <div>Scope: <span class="text-brass/70">shared</span></div>
                    <div>Trigger: Production deployment used cached layer from dev branch</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="recall">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot recall"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">13:15</span>
                  <span class="journal-type-badge recall">memory recalled</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Recalled dry-run deployment practice during production push</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Similarity: <span class="text-blue-400/70">0.89</span></div>
                    <div>Original learning from: <span class="text-chrome-dark/60">Feb 12</span></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">11:47</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Pin base images to SHA digests instead of mutable tags for reproducibility</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.91</span></div>
                    <div>Scope: <span class="text-brass/70">shared</span></div>
                    <div>Trigger: Tag :latest pointed to different image than expected</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">09:20</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Set generous initial delay on liveness probes for JVM-based services</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.88</span></div>
                    <div>Scope: <span class="text-blue-400/70">agent</span></div>
                    <div>Trigger: Pod restart loop caused by premature health check failure</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Day: Monday Feb 17 -->
        <div class="journal-day mb-8" data-day="1">
          <div class="flex items-center gap-3 mb-4 relative">
            <div class="w-[10px] h-[10px] rounded-full bg-void-deep border-2 border-brass/40 z-10 relative left-[-1px]"></div>
            <span class="font-serif text-[14px] font-semibold text-chrome/90">Monday, Feb 17</span>
            <span class="font-mono text-[10px] text-chrome-dark/30 ml-auto">2 learnings, 1 resolve</span>
          </div>

          <div class="ml-7 space-y-2">
            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">16:05</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Parallelize test suites by module to cut CI time by 60%</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.79</span></div>
                    <div>Scope: <span class="text-blue-400/70">agent</span></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="resolve">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot resolve"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">14:30</span>
                  <span class="journal-type-badge resolve">state resolved</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Resolved contradiction: CI caching helps vs. causes stale builds. Conclusion: cache dependencies, never cache build output.</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Affected: <span class="text-emerald-400/70">2 learnings merged</span></div>
                    <div>New confidence: <span class="text-brass/70">0.86</span></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">10:12</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Configure alerts for p99 latency, not just average response time</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.85</span></div>
                    <div>Scope: <span class="text-brass/70">shared</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Day: Friday Feb 14 -->
        <div class="journal-day mb-8" data-day="2">
          <div class="flex items-center gap-3 mb-4 relative">
            <div class="w-[10px] h-[10px] rounded-full bg-void-deep border-2 border-brass/40 z-10 relative left-[-1px]"></div>
            <span class="font-serif text-[14px] font-semibold text-chrome/90">Friday, Feb 14</span>
            <span class="font-mono text-[10px] text-chrome-dark/30 ml-auto">1 learning, 2 recalls</span>
          </div>

          <div class="ml-7 space-y-2">
            <div class="journal-entry" data-type="recall">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot recall"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">15:40</span>
                  <span class="journal-type-badge recall">memory recalled</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Recalled infrastructure-as-code pattern when setting up new environment</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Similarity: <span class="text-blue-400/70">0.92</span></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">11:22</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Use pre-commit hooks to scan for secrets before they reach the repository</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.97</span></div>
                    <div>Scope: <span class="text-brass/70">shared</span></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="recall">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot recall"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">09:05</span>
                  <span class="journal-type-badge recall">memory recalled</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Recalled blue-green deployment pattern from last week's incident</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Similarity: <span class="text-blue-400/70">0.84</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Day: Thursday Feb 13 -->
        <div class="journal-day mb-4" data-day="3">
          <div class="flex items-center gap-3 mb-4 relative">
            <div class="w-[10px] h-[10px] rounded-full bg-void-deep border-2 border-brass/40 z-10 relative left-[-1px]"></div>
            <span class="font-serif text-[14px] font-semibold text-chrome/90">Thursday, Feb 13</span>
            <span class="font-mono text-[10px] text-chrome-dark/30 ml-auto">2 learnings</span>
          </div>

          <div class="ml-7 space-y-2">
            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">17:50</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Use expand-contract pattern for database migrations to avoid downtime</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.66</span></div>
                    <div>Scope: <span class="text-chrome-dark/50">session</span></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="journal-entry" data-type="learn">
              <div class="journal-entry-card">
                <div class="flex items-center gap-2 mb-1">
                  <span class="journal-dot learn"></span>
                  <span class="font-mono text-[10px] text-chrome-dark/30">13:15</span>
                  <span class="journal-type-badge learn">learning stored</span>
                </div>
                <p class="font-serif text-[13px] text-chrome/80 m-0 leading-relaxed">Identical infrastructure modules for staging and production prevent environment drift</p>
                <div class="journal-detail hidden mt-2 pt-2 border-t border-brass/5">
                  <div class="font-mono text-[10px] text-chrome-dark/40 space-y-1">
                    <div>Confidence: <span class="text-brass/70">0.91</span></div>
                    <div>Scope: <span class="text-brass/70">shared</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- ToC -->
  <Fragment slot="toc">
    <a href="#the-experience" class="block py-1 text-[12px] font-serif text-chrome-dark/50 hover:text-brass transition-colors">The experience</a>
    <a href="#what-it-reveals" class="block py-1 text-[12px] font-serif text-chrome-dark/50 hover:text-brass transition-colors">What it reveals</a>
    <a href="#deja-connection" class="block py-1 text-[12px] font-serif text-chrome-dark/50 hover:text-brass transition-colors">Deja connection</a>
    <a href="#do-it-with-deja" class="block py-1 text-[12px] font-serif text-chrome-dark/50 hover:text-brass transition-colors">Do it with deja</a>
    <a href="#design-tensions" class="block py-1 text-[12px] font-serif text-chrome-dark/50 hover:text-brass transition-colors">Design tensions</a>
    <a href="#the-event-stream" class="block py-1 text-[12px] font-serif text-chrome-dark/50 hover:text-brass transition-colors">The event stream</a>
  </Fragment>

  <!-- Content -->
  <h2 id="the-experience">The experience</h2>

  <p>You scroll down. Time flows with you. Each day is a cluster -- a heading with a date, followed by the events of that day arranged newest-first. Tuesday had four events: three learnings stored and one memory recalled. Monday had a resolution, where two contradictory memories were merged into something cleaner. Friday was quieter, just a learning and two recalls. Thursday shows two new learnings born from a migration experiment.</p>

  <p>The timeline has a visual grammar that takes about ten seconds to learn. Gold dots are learnings -- new knowledge stored for the first time. Blue dots are recalls -- moments when existing knowledge was surfaced and used. Green dots are resolutions -- contradictions noticed and merged. The vertical line connecting them all is time itself, and a subtle pulse travels down it like a heartbeat, suggesting that this stream is alive and ongoing.</p>

  <p>You click an entry and it expands, revealing the metadata underneath: confidence scores, scope, the original trigger that caused this memory to form. You notice that Tuesday's afternoon was dense with activity -- three learnings in five hours, all related to Docker builds. Something happened that day. The journal does not tell you what, exactly, but it shows you that a cluster of learning occurred. That pattern is legible only because the entries are arranged in time.</p>

  <p>At the top, a summary: "3 learnings, 1 recall" for Tuesday. These counters are small but informative. They let you scan the week without reading every entry. You can see at a glance that Monday was a resolution day -- the agent was consolidating knowledge, not acquiring it. That rhythm tells a story the filing cabinet never could.</p>

  <h2 id="what-it-reveals">What it reveals</h2>

  <p>The journal reveals temporal patterns. It answers questions like: When does this agent learn most? Are there dry spells -- periods of days or weeks with no new memories? Is there a cadence to recall? Do resolutions tend to happen after bursts of learning, or independently?</p>

  <p>These are not questions anyone asks of a database table. They are the questions you ask of a narrative. The journal transforms raw event data into something that reads like a story, even if it is a story told in fragments. And stories expose structure that lists cannot. A cluster of three deployment learnings on one afternoon implies a deployment went wrong. A recall followed by a new learning suggests the agent used past knowledge and then refined it. A resolution event sitting between two contradictory learnings tells you the system is self-correcting.</p>

  <p>The journal also makes activity volume visible. In a filing cabinet, 10 memories and 1,000 memories look like different-length scrolls. In a journal, the difference between a productive week and a quiet one is the visual density of the page. Dense clusters feel active. Sparse days feel quiet. The metaphor is physical -- you can see the weight of knowledge accumulating, or the lightness of a period where nothing was learned.</p>

  <p>What the journal does not reveal is semantic structure. Two entries from the same day might be deeply related or completely unrelated. The journal arranges by time, not by meaning. It shows you <em>when</em> things happened, which is valuable, but it tells you nothing about the topological relationships between the things themselves.</p>

  <h2 id="deja-connection">How it connects to deja</h2>

  <p>The journal is built from two data sources in deja: the <code>created_at</code> timestamps on learnings, and the state events tracked in the <code>state_revisions</code> table. Every learning has a creation timestamp. Every state change -- a confidence update, a scope promotion, a deletion -- is logged as a revision. Together, these form a complete event stream.</p>

  <p>To build the journal, you would query learnings sorted by <code>created_at DESC</code> and interleave them with state revisions sorted by their own timestamps. The result is a unified timeline of everything that happened to memory. Client-side grouping by day is trivial -- parse the date, bucket by <code>YYYY-MM-DD</code>, render each bucket as a cluster.</p>

  <p>The recall events are slightly more complex. Today, deja does not explicitly log when a memory is recalled during <code>/inject</code>. The inject endpoint returns matching memories, but it does not persist the fact that a recall occurred. To build a proper journal, deja would need a lightweight recall log -- perhaps a <code>recall_events</code> table that records which memories were injected, with what similarity score, at what time. This is a small schema addition with large interface implications.</p>

  <p>The summary counters per day are pure aggregation: <code>COUNT(*) GROUP BY event_type, DATE(created_at)</code>. This query is fast even at scale, and it provides the data for a sparkline or activity chart that could sit above the timeline as a navigational aid.</p>

  <DoItWithDeja
    blurb="GET /learnings ordered by created_at, group by day client-side. Interleave with state_revisions for full event stream."
    snippets={[
      {
        label: 'List learnings by date',
        code: `curl -X GET "https://deja.your-subdomain.workers.dev/learnings?scope=shared&limit=100&sort=created_at_desc" \\
  -H "Authorization: Bearer YOUR_API_KEY"`,
      },
    ]}
  />

  <h2 id="design-tensions">Design tensions</h2>

  <p>Journals are passive. This is their fundamental design tension. You scroll, you read, you see what happened. But then what? A journal that does not lead to action is just a log file with better typography. The most dangerous version of the journal is one that looks beautiful and feels informative but changes nothing about how you interact with memory.</p>

  <p>The actionable journal would need affordances: click a learning to edit it, flag a suspicious entry for review, select a cluster and ask "what happened here?" to trigger a synthesis. Without these, the journal is a read-only window into the past. Informative, certainly. But memory interfaces need to support not just observation but intervention.</p>

  <p>There is also a scale problem. A journal works well for days and weeks. It starts to break at months and years. At that scale, scrolling becomes impractical and the visual density overwhelms. The journal needs a zoom mechanism -- monthly summaries that expand into weekly views that expand into daily detail. This is architecturally simple but design-heavy. The challenge is not building it but making each zoom level feel intentional rather than just "smaller text."</p>

  <p>Finally, the journal privileges recency. The most recent events are at the top, which means the oldest knowledge is buried at the bottom. This is the right default for monitoring -- you want to see what just happened. But it is the wrong default for understanding, because the foundational memories that anchor everything else are the oldest ones. A journal needs a way to surface significance independent of time, and that is a harder problem than chronological ordering.</p>

  <h2 id="the-event-stream">The event stream</h2>

  <p>Underneath the journal metaphor is a technical primitive: the event stream. Every interaction with memory -- create, read, update, delete, recall, resolve -- is an event with a timestamp, an actor, and a payload. Deja's <code>state_revisions</code> table already captures the write side of this stream. What is missing is the read side: the record of when and how memories were accessed.</p>

  <p>A complete event stream enables more than just the journal. It enables replay -- the ability to reconstruct the state of memory at any point in time. It enables auditing -- who changed what, when, and why. It enables analytics -- usage patterns, hot memories, cold memories, decay curves. The event stream is the foundation on which several other interfaces in this research series are built.</p>

  <p>The schema is minimal. An event record needs: <code>event_type</code> (enum: created, updated, deleted, recalled, resolved), <code>memory_id</code> (which learning was affected), <code>actor_id</code> (which agent or user triggered it), <code>timestamp</code>, and <code>metadata</code> (a JSON blob for event-specific details like similarity scores or confidence deltas). This is a write-heavy, read-occasionally table -- the classic append-only log pattern.</p>

  <p>If deja were to implement a single infrastructure addition to support the next generation of memory interfaces, the event stream would be it. Not because the journal is the most compelling interface (it is not), but because the event stream is the raw material from which dozens of interfaces can be built. The journal is simply the most obvious one.</p>
</ResearchLayout>

<style>
  .journal-demo {
    font-family: var(--font-serif), serif;
  }

  .journal-scroll {
    scrollbar-width: thin;
    scrollbar-color: rgba(201, 169, 97, 0.15) transparent;
  }

  .journal-scroll::-webkit-scrollbar {
    width: 4px;
  }

  .journal-scroll::-webkit-scrollbar-track {
    background: transparent;
  }

  .journal-scroll::-webkit-scrollbar-thumb {
    background: rgba(201, 169, 97, 0.15);
    border-radius: 2px;
  }

  .journal-pulse-line {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background: linear-gradient(180deg, rgba(201, 169, 97, 0.4), transparent);
    animation: journal-pulse 3s ease-in-out infinite;
  }

  @keyframes journal-pulse {
    0% { top: -60px; opacity: 0; }
    15% { opacity: 1; }
    85% { opacity: 1; }
    100% { top: 100%; opacity: 0; }
  }

  .journal-dot {
    display: inline-block;
    width: 7px;
    height: 7px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .journal-dot.learn {
    background: #c9a961;
    box-shadow: 0 0 6px rgba(201, 169, 97, 0.4);
  }

  .journal-dot.recall {
    background: #60a5fa;
    box-shadow: 0 0 6px rgba(96, 165, 250, 0.4);
  }

  .journal-dot.resolve {
    background: #34d399;
    box-shadow: 0 0 6px rgba(52, 211, 153, 0.4);
  }

  .journal-type-badge {
    font-family: var(--font-mono), monospace;
    font-size: 9px;
    font-weight: 600;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    padding: 1px 5px;
    border-radius: 2px;
  }

  .journal-type-badge.learn {
    color: #c9a961;
    background: rgba(201, 169, 97, 0.1);
  }

  .journal-type-badge.recall {
    color: #60a5fa;
    background: rgba(96, 165, 250, 0.1);
  }

  .journal-type-badge.resolve {
    color: #34d399;
    background: rgba(52, 211, 153, 0.1);
  }

  .journal-entry-card {
    background: rgba(26, 26, 26, 0.5);
    border: 1px solid rgba(201, 169, 97, 0.06);
    border-radius: 3px;
    padding: 10px 14px;
    cursor: pointer;
    transition: border-color 0.15s ease, background-color 0.15s ease;
  }

  .journal-entry-card:hover {
    border-color: rgba(201, 169, 97, 0.12);
    background: rgba(26, 26, 26, 0.7);
  }

  .journal-entry-card.expanded {
    border-color: rgba(201, 169, 97, 0.18);
    background: rgba(26, 26, 26, 0.8);
  }

  .journal-day {
    opacity: 0;
    transform: translateY(12px);
    animation: journal-day-enter 0.5s ease-out forwards;
  }

  .journal-day[data-day="0"] { animation-delay: 0.1s; }
  .journal-day[data-day="1"] { animation-delay: 0.25s; }
  .journal-day[data-day="2"] { animation-delay: 0.4s; }
  .journal-day[data-day="3"] { animation-delay: 0.55s; }

  @keyframes journal-day-enter {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  // Click to expand/collapse entries
  document.querySelectorAll('.journal-entry-card').forEach(card => {
    card.addEventListener('click', () => {
      const detail = card.querySelector('.journal-detail');
      const isExpanded = card.classList.contains('expanded');

      // Collapse all others
      document.querySelectorAll('.journal-entry-card.expanded').forEach(other => {
        if (other !== card) {
          other.classList.remove('expanded');
          other.querySelector('.journal-detail')?.classList.add('hidden');
        }
      });

      // Toggle this one
      if (isExpanded) {
        card.classList.remove('expanded');
        detail?.classList.add('hidden');
      } else {
        card.classList.add('expanded');
        detail?.classList.remove('hidden');
      }
    });
  });
</script>
